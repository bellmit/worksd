
<style>
.col-md-0{
    position: relative;
    min-height: 1px;
    padding-left: 15px
}
.col-md-0{
    float: left
}
a:hover {text-decoration: none;}
th{text-align:center;}
</style>
			<div  class="container" style="width:2000px">
				<div class="crumbs">
		            <ul id="breadcrumbs" class="breadcrumb">
		              <li>
		                <i class="icon-home">
		                </i>
		                <a href="index.html">
		                </a>
		              </li>
		              <li class="current">
		                <a href="pages_calendar.html" title="" id="aa">
		                               Danh sách thống kê truy thu
		                </a>
		              </li>
		            </ul>
		        </div>
		        <div class="row" style="margin-top: 10px;">
		            <div class="col-md-12">
		              <div class="widget box">
		                <div class="widget-header">
		                  <h4 id="bb">
		                    <i class="icon-reorder">
		                    </i>
		                                        Điều kiện chọn
		                  </h4>
		                </div>
		                <div class="widget-content">
						  <div>
						     <input type="hidden" id="cupage" value="1"/>
							 <input type="hidden" id="total" value="1"/>
							 <input type="hidden" id="formurl" value="/servlet/current/AccountShenheAction?function=GetCuishouAccount"/>
                             <input type="hidden" id="starTime" value=""/>
                             <input type="hidden" id="endTime" value=""/>
						  </div>
		                    <div class="form-group">
                              <div class="col-md-4" style="width:150px;">
                                  <select class="form-control" name="select" id="tempselect" onChange="gradeChange()" >
                                      <option value="0" id="cc">
                                        Toàn bộ
                                      </option>
                                      <option value="1" id="dd">
                                        Họ tên người xét duyệt
                                      </option>
                                      <option value="2" id="ee">
                                       Số ĐTDĐ
                                      </option>
                                      <option value="3" id="eeeeee">
                                       day
                                      </option>
                               	  </select>
                              </div>
                               <div class="col-md-1" style="width:200px;">
		                        <input type="text" name="regular" class="form-control" id="tempVelue" placeholder="Vui lòng nhập thông tin tìm kiếm" >
		                      </div>
                             <label class="col-md-0 control-label" style="padding-top:5px;" id="ff">
		                                             Thời gian thống kê:
		                      </label>
                               <div class="col-md-2">
                                <input type="text" name="regular" class="form-control datepicker" id="date1" onBlur="onb()">
                              </div>
			                  <button id="btn-load" class="btn btn-primary" data-loading-text="loading...">
			                                     Tìm kiếm
			                  </button>
			                   &nbsp;&nbsp;&nbsp;
                              <button type="button" class="btn btn-success" onclick="method5('tableExcel')">excel</button>
			                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			               <button type="button" class="btn btn-success" onclick="changeLan()">Change</button> 
		                    </div>
		                  
		                </div>
		              </div>
		            </div>
		        </div>
		        <div class="row">
		            <div class="col-md-12">
		              <div class="widget box">
		                <div class="widget-header">
		                  <h4 id="gg">
		                    <i class="icon-reorder">
		                    </i>
		                               Danh sách thống kê truy thu
		                  </h4>
		                  <div class="toolbar no-padding">
		                    <div class="btn-group">
		                      <span class="btn btn-xs widget-collapse">
		                        <i class="icon-angle-down">
		                        </i>
		                      </span>
		                    </div>
		                  </div>
		                </div>
		                <div class="widget-content">
		                  <table class="table table-hover table-striped table-bordered table-highlight-head" style="text-align:center" id="tableExcel">
		                    <thead>
		                      <tr style="text-align:center">
		                         <th rowspan="2" style=" line-height:50px;" id="hh">
                                          Mã số người truy thu
                                    </th>
                                    <th rowspan="2"  style=" line-height:50px;" id="ii">
                                         Họ tên người truy thu
                                    </th>
                                    <th rowspan="2"  style=" line-height:50px;" id="jj">
                                         Số ĐTDĐ
                                    </th>
                                    <th colspan="5" style=" font-size:14px; font-weight:bold;" id="kk">
                                          Thống kê số món vay trong ngày
                                    </th>
                                   
                                     <th colspan="20"  style=" font-size:14px; font-weight:bold;" id="ll">
                                        Thống kê Tổng số món vay
                                    </th>
                                    
		                      </tr>
                              <tr  style="text-align:center">

                                    <th id="mm">
                                         Tổng số món vay
                                    </th>
                                    <th id="nn">
                                         Số món vay M1 (Quá hạn 1-3 ngày)
                                    </th>
                                    <th id="oo">
                                         Số món vay M2 (Quá hạn 3-7 ngày)
                                    </th>
                                    <th id="pp">
                                         Số món vay M3 (Quá hạn 7-30 ngày)
                                    </th>
                                    <th id="qq">
                                        Số món vay M4 (Quá hạn trên 30 ngày)
                                    </th>
                                     <th id="rr">
                                         Tổng số lần vay
                                    </th>
                                    <th id="ss">
                                         Số món vay M1 (Quá hạn 1-3 ngày)
                                    </th>
                                    <th id="tt">
                                        Số tiền M1 (Quá hạn 1-3 ngày)
                                    </th>
                                    <th id="uu">
                                        Số món vay M2 (Quá hạn 3-7 ngày)
                                    </th>
                                    <th id="vv">
                                        Số tiền M2 (Quá hạn 3-7 ngày)
                                    </th>
                                    <th id="ww">
                                         Số món vay M3 (Quá hạn 7-30 ngày)
                                    </th>
                                    <th id="xx">
                                         Số tiền M3 (Quá hạn 7-30 ngày)
                                    </th>
                                    <th id="yy">
                                        Số món vay M4 (Quá hạn trên 30 ngày)
                                    </th>
                                    <th id="zz">
                                        Số tiền M4 (Quá hạn trên 30 ngày)
                                    </th>
                                    <th id="aaa">
                                        Tổng số tiền truy thu
                                    </th>
                                    <th id="bbb">
                                         Tổng số tiền đã truy thu
                                    </th>
                                    <th id="ccc">
                                         Tỷ lệ
                                    </th>
                                    <th id="kkk">
                                         Số món quá hạn tăng thêm trong tháng
                                    </th>
                                    <th id="lll">
                                         Tổng số tiền truy thu tăng thêm trong tháng
                                    </th>
                                    <th id="mmm">
                                         Tổng số tiền đã truy thu trong tháng
                                    </th>
                                    <th id="nnn">
                                         Tỷ lệ truy thu về trong tháng
                                    </th>
                                    <th id="hhhh">
                                         Tổng số món gia hạn
                                    </th>
                                    <th id="hhh">
                                         Tổng số tiền truy thu (gồm gia hạn)
                                    </th>
                                    <th id="iii">
                                         Số tiền đã gia hạn
                                    </th>
                                    <th id="jjj">
                                         Tỷ lệ gia hạn
                                    </th>
		                      </tr>
		                    </thead>
		                    <tbody id="load_data">
		                      
		                    </tbody>
		                  </table>
                          
 <div class="row"><div class="dataTables_footer clearfix"><div class="col-md-6"><div class="dataTables_info" id="DataTables_Table_0_info">Tổng số<font id="totalrows"></font>tin, mỗi trang chứa được <font id="numperpage"></font>tin, hiện tại trang số<font id="currentpage"></font> / <font id="totalpages"></font>trang</div></div><div class="col-md-6"><div class="dataTables_paginate paging_bootstrap" id="datatable"></div></div></div></div>


		                </div>
		              </div>
		            </div>
		          </div>
			</div>
<script>
function changeLan(){
loadGetServer("/servlet/current/JBDcms3Action?function=GetChangeCS",{},function(data){
	if(data.error == 1){
		document.getElementById("aa").innerHTML = data.aa;
		document.getElementById("bb").innerHTML = data.bb;
		document.getElementById("cc").innerHTML = data.cc;
		document.getElementById("dd").innerHTML = data.dd;
		document.getElementById("ee").innerHTML = data.ee;
		document.getElementById("eeeeee").innerHTML = data.eeeeee;
		document.getElementById("ff").innerHTML = data.ff;
		document.getElementById("gg").innerHTML = data.gg;
		document.getElementById("hh").innerHTML = data.hh;
		document.getElementById("ii").innerHTML = data.ii;
		document.getElementById("jj").innerHTML = data.jj;
		document.getElementById("kk").innerHTML = data.kk;
		document.getElementById("ll").innerHTML = data.ll;
		document.getElementById("mm").innerHTML = data.mm;
		document.getElementById("nnn").innerHTML = data.nnn;
		document.getElementById("nn").innerHTML = data.nn;
		document.getElementById("oo").innerHTML = data.oo;
		document.getElementById("pp").innerHTML = data.pp;
		document.getElementById("qq").innerHTML = data.qq;
		document.getElementById("rr").innerHTML = data.rr;
		document.getElementById("ss").innerHTML = data.ss;
		document.getElementById("tt").innerHTML = data.tt;
		document.getElementById("uu").innerHTML = data.uu;
		document.getElementById("vv").innerHTML = data.vv;
		document.getElementById("ww").innerHTML = data.ww;
		document.getElementById("xx").innerHTML = data.xx;
		document.getElementById("yy").innerHTML = data.yy;
		document.getElementById("zz").innerHTML = data.zz;
		document.getElementById("aaa").innerHTML = data.aaa;
		document.getElementById("bbb").innerHTML = data.bbb;
		document.getElementById("ccc").innerHTML = data.ccc;
		document.getElementById("hhh").innerHTML = data.hhh;
		document.getElementById("hhhh").innerHTML = data.hhhh;
		document.getElementById("iii").innerHTML = data.iii;
		document.getElementById("jjj").innerHTML = data.jjj;
		document.getElementById("kkk").innerHTML = data.kkk;
		document.getElementById("lll").innerHTML = data.lll;
		document.getElementById("mmm").innerHTML = data.mmm;
		document.getElementById("nnn").innerHTML = data.nnn;
	}else{
		alert("error!");
	}

});
	

}

</script>
<script>
	$("#btn-load").on("click", function() {
		var a = $(this);
		a.button("loading");
		$("#cupage").val("1");
		load_data();
	
	});
	function toThousands(num) {  
	    		var num = (num || 0).toString(), result = '';  
	    		while (num.length > 3) {  
	        		result = ',' + num.slice(-3) + result;  
	        		num = num.slice(0, num.length - 3);  
	    		}  
	    		if (num) { 
				result = num + result; 
			}  
    			return result;  
	}
	function load_data()
	{
	
	  var tempsele=$("#tempselect").val();
	  var tempval=$("#tempVelue").val();
	  var starTime=$("#starTime").val();
	  var endTime=$("#endTime").val();
	  var para={curPage:$("#cupage").val(),temp:tempsele,tempvl:tempval,startDate:starTime,endDate:endTime};
	  loadGetServer($("#formurl").val(),para,function(data){
		  $("#load_data").html("");
		  var list = data.list.data;
		  var html_="";
		  var jrzbs = 0;
			var jrtxzbs = 0;
			var jrcszbs1 = 0;
			var jrcszbs2 = 0;
			var jrcszbs3 = 0;
			var jrcszbs4 = 0;
			var zbs = 0;
			var ycszbs = 0;
			var cszbs1 = 0;
			var cszje1 = 0;
			var cszbs2 = 0;
			var cszje2 = 0;
			var cszbs3 = 0;
			var cszje3 = 0;
			var cszbs4 = 0;
			var cszje4 = 0;
			var zcsjebyq = 0;
			var zcsje = 0;
			var zcsbl = 0;
			var yqzbs = 0;
			var zcsjeyyq = 0;
			var yqzje = 0;
			var yqzbl = 0;
			var txzbs = 0;
			var txyhzbs = 0;
			var txzje = 0;
			var txyhzje = 0;
			var txyhzbl = 0;
		  for(var i=0;i<list.length;i++)
		  {
		  	var ycstotal = parseInt(list[i].one)+parseInt(list[i].two)+parseInt(list[i].three)+parseInt(list[i].threeTG) ;
			var aa = list[i].jrtotalYCSmoney.replace(/,/g,"");
			var bb = list[i].jrtotalCSmoney.replace(/,/g,"");
			var jrcsbl = 0; 
			if(parseInt(aa) == 0){
				jrcsbl=0;
			}else{
				jrcsbl= parseInt(parseInt(aa) *100 / parseInt(bb)) ;
			}
			var aaa = list[i].totalYCSmoney.replace(/,/g,"");
			var bbb = list[i].totalCSmoney1.replace(/,/g,"");
			var ycsbl = 0; 
			if(parseInt(aaa) == 0){
				ycsbl=0;
			}else{
				ycsbl= parseInt(parseInt(aaa) *100 / parseInt(bbb)) ;
			}
			var aaaa = list[i].totalYCSmoney2.replace(/,/g,"");
			var bbbb = list[i].totalCSmoney.replace(/,/g,"");
			var ycsblyq = 0; 
			if(parseInt(aaaa) == 0){
				ycsblyq=0;
			}else{
				ycsblyq= parseInt(parseInt(aaaa) *100 / parseInt(bbbb)) ;
			}
			var zszs = parseInt(list[i].jrcount);
			/* if(list[i].userid == "19" || list[i].userid == "23"){
				html_ += "<tr><td bgcolor='#CCCCCC'>BPXLN"+list[i].userid+"</td><td bgcolor='#CCCCCC'>"+list[i].userName+"</td><td bgcolor='#CCCCCC'>"+list[i].phone+"</td><td bgcolor='#CCCCCC'><span class='label label-success'>"+list[i].nowCount+"</span></td><td bgcolor='#CCCCCC'>"+list[i].nowOnesh+"</td><td bgcolor='#CCCCCC'>"+list[i].nowTwosh+"</td><td bgcolor='#CCCCCC'>"+list[i].nowThreesh+"</td><td bgcolor='#CCCCCC'>"+list[i].nowFoursh+"</td><td bgcolor='#CCCCCC'><span class='label label-success'>"+list[i].count+"</span>-<span style='color:#F00'>"+ycstotal+"</span></td><td bgcolor='#CCCCCC'>"+list[i].one+"</td><td bgcolor='#CCCCCC'>"+list[i].onemoney+"</td><td bgcolor='#CCCCCC'>"+list[i].two+"</td><td bgcolor='#CCCCCC'>"+list[i].twomoney+"</td><td bgcolor='#CCCCCC'>"+list[i].three+"</td><td bgcolor='#CCCCCC'>"+list[i].threemoney+"</td><td bgcolor='#CCCCCC'>"+list[i].threeTG+"</td><td bgcolor='#CCCCCC'>"+list[i].threeTGmoney+"</td><td bgcolor='#CCCCCC'>"+list[i].totalCSmoney1+"</td><td bgcolor='#CCCCCC'>"+list[i].totalYCSmoney+"</td><td bgcolor='#CCCCCC'>"+ycsbl+"%</td><td bgcolor='#CCCCCC'><span class='label label-success'>"+zszs+"</span>-<span style='color:#F00'>"+list[i].jrycscount+"</span></td><td bgcolor='#CCCCCC'>"+list[i].jrtotalCSmoney+"</td><td bgcolor='#CCCCCC'>"+list[i].jrtotalYCSmoney+"</td><td bgcolor='#CCCCCC'>"+jrcsbl+"%</td><td bgcolor='#CCCCCC'><span class='label label-success'>"+list[i].countyq+"</td><td bgcolor='#CCCCCC'>"+list[i].totalCSmoney+"</td><td bgcolor='#CCCCCC'>"+list[i].totalYCSmoney2+"</td><td bgcolor='#CCCCCC'>"+ycsblyq+"%</td>";
				html_ +="</tr>";
			}else{ */
				html_ += "<tr><td>BPXLN"+list[i].userid+"</td><td>"+list[i].userName+"</td><td>"+list[i].phone+"</td><td><span class='label label-success'>"+list[i].nowCount+"</span></td><td>"+list[i].nowOnesh+"</td><td>"+list[i].nowTwosh+"</td><td>"+list[i].nowThreesh+"</td><td>"+list[i].nowFoursh+"</td><td><span class='label label-success'>"+list[i].count+"</span>-<span style='color:#F00'>"+ycstotal+"</span></td><td>"+list[i].one+"</td><td>"+list[i].onemoney+"</td><td>"+list[i].two+"</td><td>"+list[i].twomoney+"</td><td>"+list[i].three+"</td><td>"+list[i].threemoney+"</td><td>"+list[i].threeTG+"</td><td>"+list[i].threeTGmoney+"</td><td>"+list[i].totalCSmoney1+"</td><td>"+list[i].totalYCSmoney+"</td><td>"+ycsbl+"%</td><td><span class='label label-success'>"+zszs+"</span>-<span style='color:#F00'>"+list[i].jrycscount+"</span></td><td>"+list[i].jrtotalCSmoney+"</td><td>"+list[i].jrtotalYCSmoney+"</td><td>"+jrcsbl+"%</td><td><span class='label label-success'>"+list[i].countyq+"</td><td>"+list[i].totalCSmoney+"</td><td>"+list[i].totalYCSmoney2+"</td><td>"+ycsblyq+"%</td>";
				html_ +="</tr>";
				//}
			
			jrzbs += list[i].nowCount;
			jrtxzbs += list[i].jrnowOnesh;
			jrcszbs1 += list[i].nowOnesh;
			jrcszbs2 += list[i].nowTwosh;
			jrcszbs3 += list[i].nowThreesh;
			jrcszbs4 += list[i].nowFoursh;
			zbs += list[i].count;
			ycszbs += ycstotal;
			cszbs1 += list[i].one;
			cszje1 += parseInt(list[i].onemoney.replace(/,/g,""));
			cszbs2 += list[i].two;
			cszje2 += parseInt(list[i].twomoney.replace(/,/g,""));
			cszbs3 += list[i].three;
			cszje3 += parseInt(list[i].threemoney.replace(/,/g,""));
			cszbs4 += list[i].threeTG;
			cszje4 += parseInt(list[i].threeTGmoney.replace(/,/g,""));
			zcsjebyq += parseInt(list[i].totalCSmoney1.replace(/,/g,""));
			zcsje += parseInt(list[i].totalYCSmoney.replace(/,/g,""));
			
			yqzbs += list[i].countyq;
			zcsjeyyq += parseInt(list[i].totalCSmoney.replace(/,/g,""));
			yqzje += parseInt(list[i].totalYCSmoney2.replace(/,/g,""));
			
			txzbs += zszs;
			txyhzbs += list[i].jrycscount;
			txzje += parseInt(list[i].jrtotalCSmoney.replace(/,/g,""));
			txyhzje += parseInt(list[i].jrtotalYCSmoney.replace(/,/g,""));
		   }
		   if(zcsjebyq != 0){
		   		zcsbl = parseInt(zcsje * 100 / zcsjebyq);
		   	}
		   if(zcsjeyyq != 0){
		   		yqzbl = parseInt(yqzje * 100 / zcsjeyyq);
		   	}
		   if(txzje != 0){
		   		txyhzbl = parseInt(txyhzje * 100 / txzje);
		   	}
		   	html_ += "<tr><td>Thống kê tổng</td><td>Thống kê tổng</td><td>Thống kê tổng</td><td><span class='label label-success'>"+jrzbs+"</span></td><td>"+jrcszbs1+"</td><td>"+jrcszbs2+"</td><td>"+jrcszbs3+"</td><td>"+jrcszbs4+"</td><td><span class='label label-success'>"+zbs+"</span>-<span style='color:#F00'>"+ycszbs+"</span></td><td>"+cszbs1+"</td><td>"+toThousands(cszje1)+"</td><td>"+cszbs2+"</td><td>"+toThousands(cszje2)+"</td><td>"+cszbs3+"</td><td>"+toThousands(cszje3)+"</td><td>"+cszbs4+"</td><td>"+toThousands(cszje4)+"</td><td>"+toThousands(zcsjebyq)+"</td><td>"+toThousands(zcsje)+"</td><td>"+zcsbl+"%</td><td><span class='label label-success'>"+txzbs+"</span>-<span style='color:#F00'>"+txyhzbs+"</span></td><td>"+toThousands(txzje)+"</td><td>"+toThousands(txyhzje)+"</td><td>"+txyhzbl+"%</td><td><span class='label label-success'>"+yqzbs+"</td><td>"+toThousands(zcsjeyyq)+"</td><td>"+toThousands(yqzje)+"</td><td>"+yqzbl+"%</td>";
			html_ +="</tr>";
			$("#load_data").append(html_);
			$("#tempselect").val(data.temp);
			$("#tempVelue").val(data.tempvalu);
			page_value(data);
			page_data();
			$("#btn-load").button("reset");
	    });
   }  
   
   function gradeChange(){
	   var tempselect=$("#tempselect").val();
	   if(tempselect==0){
	       $("#tempVelue").val("");
	   }
	}
   
   load_data();
   

   
</script>

<script>
 var idTmr;  
        function  getExplorer() {  
            var explorer = window.navigator.userAgent ;  
            //ie  
            if (explorer.indexOf("MSIE") >= 0) {  
                return 'ie';  
            }  
            //firefox  
            else if (explorer.indexOf("Firefox") >= 0) {  
                return 'Firefox';  
            }  
            //Chrome  
            else if(explorer.indexOf("Chrome") >= 0){  
                return 'Chrome';  
            }  
            //Opera  
            else if(explorer.indexOf("Opera") >= 0){  
                return 'Opera';  
            }  
            //Safari  
            else if(explorer.indexOf("Safari") >= 0){  
                return 'Safari';  
            }  
        }  
        function method5(tableid) {  
            if(getExplorer()=='ie')  
            {  
                var curTbl = document.getElementById(tableid);  
                var oXL = new ActiveXObject("Excel.Application");  
                var oWB = oXL.Workbooks.Add();  
                var xlsheet = oWB.Worksheets(1);  
                var sel = document.body.createTextRange();  
                sel.moveToElementText(curTbl);  
                sel.select();  
                sel.execCommand("Copy");  
                xlsheet.Paste();  
                oXL.Visible = true;  
  
                try {  
                    var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");  
                } catch (e) {  
                    print("Nested catch caught " + e);  
                } finally {  
                    oWB.SaveAs(fname);  
                    oWB.Close(savechanges = false);  
                    oXL.Quit();  
                    oXL = null;  
                    idTmr = window.setInterval("Cleanup();", 1);  
                }  
  
            }  
            else  
            {  
                tableToExcel(tableid)  
            }  
        }  
        function Cleanup() {  
            window.clearInterval(idTmr);  
            CollectGarbage();  
        }  
        var tableToExcel = (function() {  
            var uri = 'data:application/vnd.ms-excel;base64,',  
                    template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',  
                    base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },  
                    format = function(s, c) {  
                        return s.replace(/{(\w+)}/g,  
                                function(m, p) { return c[p]; }) }  
            return function(table, name) {  
                if (!table.nodeType) table = document.getElementById(table)  
                var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}  
                window.location.href = uri + base64(format(template, ctx))  
            }  
        })()  

</script>
<script type="text/javascript" src="/sdmain/js/date_time.js"></script>